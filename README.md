# ğŸ“ˆ Commit Stock Market

> **"ë‹¹ì‹ ê³¼ ë™ë£Œì˜ ì»¤ë°‹ì„ ê·¸ë˜í”„í™”í•˜ì„¸ìš”"**  
> GitHub ì»¤ë°‹ ë°ì´í„°ë¥¼ ê¸ˆìœµ ì§€í‘œ ê¸°ë°˜ìœ¼ë¡œ ì‹œê°í™”í•˜ëŠ” Streamlit í†µí•© ëŒ€ì‹œë³´ë“œ

---

## ğŸŒ Live Demo
ì´ í”„ë¡œì íŠ¸ëŠ” **Streamlit Community Cloud**ë¥¼ í†µí•´ ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤.  
ğŸ‘‰ **[ì„œë¹„ìŠ¤ ë°”ë¡œê°€ê¸°](https://commit-stock-market-season2.streamlit.app/)**

---

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

**Commit Stock Market**ì€ GitHub ì»¤ë°‹ í™œë™ì„ **ì£¼ì‹ ì‹œì¥ ë©”íƒ€í¬**ë¡œ í•´ì„í•˜ì—¬, ê°œë°œìì˜ í™œë™ íŒ¨í„´ì„ ì •ëŸ‰ì ìœ¼ë¡œ ë¶„ì„í•˜ëŠ” í”Œë«í¼ì…ë‹ˆë‹¤.

### ğŸ¯ í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| **7ì¼ ì´ë™ í‰ê· (7D MA)** | ì»¤ë°‹ íšŸìˆ˜ì˜ ë‹¨ê¸° ë³€ë™ì„±ì„ ì œê±°í•˜ê³  ì¤‘ì¥ê¸° ì¶”ì„¸ë¥¼ ì¶”ì¶œ |
| **ì‹¤ì‹œê°„ ì‹œì¥ ë°ì´í„°** | yfinance APIë¥¼ í†µí•œ ì£¼ì‹/ì•”í˜¸í™”í ì‹œì„¸(MSFT, NVDA, AAPL, BTC-USD ë“±) |
| **ê¸°ìˆ  ë‰´ìŠ¤ íë ˆì´ì…˜** | BeautifulSoupì„ í™œìš©í•œ GeekNews ìë™ ìˆ˜ì§‘ ë° ìˆœìœ„ í‘œì‹œ |
| **ë™ì  ë­í‚¹ ì‹œìŠ¤í…œ** | ê°œë°œìì˜ ì»¤ë°‹ í™œë™ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ìˆœìœ„í™”í•˜ì—¬ ì‹œê°í™” |
| **GitHub API ì—°ë™** | ì§€ì •ëœ ì €ì¥ì†Œì˜ ìµœê·¼ 30ì¼ ì»¤ë°‹ ë°ì´í„° ìë™ ë™ê¸°í™” |

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```plaintext
commit-stock-market/
â”œâ”€â”€ Home.py                    # ë©”ì¸ í˜ì´ì§€ (ìœ ì € ë“±ë¡ ë° ì‹œì¥ ê°œìš”)
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ 1-Ranking.py           # 7ì¼ ì´ë™í‰ê·  ê¸°ë°˜ ë­í‚¹ ë° ì°¨íŠ¸ ë¶„ì„
â”‚   â””â”€â”€ 2-GEEKNEWS.py          # ê¸°ìˆ  ë‰´ìŠ¤ í¬ë¡¤ë§ ë° íë ˆì´ì…˜
â”œâ”€â”€ utils.py                   # ë°ì´í„°ë² ì´ìŠ¤ ë° API ê³µí†µ í•¨ìˆ˜
â”œâ”€â”€ init.db.sql                # MySQL ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
â”œâ”€â”€ requirements.txt           # Python ì˜ì¡´ì„± ëª©ë¡
â””â”€â”€ README.md                  # ì´ ë¬¸ì„œ
```

---

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### ë°±ì—”ë“œ & í”„ë ˆì„ì›Œí¬
- **í”„ë ˆì„ì›Œí¬**: Streamlit 1.53.1 (ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜)
- **ì–¸ì–´**: Python 3.x
- **ë°°í¬**: Streamlit Community Cloud

### ë°ì´í„°ë² ì´ìŠ¤
- **DBMS**: MySQL
- **ORM**: SQLAlchemy (Pandas read_sql í˜¸í™˜ì„±)
- **ë“œë¼ì´ë²„**: PyMySQL

### ë°ì´í„° ì²˜ë¦¬ & ë¶„ì„
- **ë°ì´í„° ì¡°ì‘**: Pandas 2.3.3, NumPy 2.4.1
- **ì‹œê³„ì—´ ë¶„ì„**: Pandas `rolling()` ë©”ì„œë“œ (7ì¼ ì´ë™í‰ê· )
- **API ìš”ì²­**: Requests 2.32.5

### ì™¸ë¶€ ë°ì´í„° ì†ŒìŠ¤
- **ê¸ˆìœµ ë°ì´í„°**: yfinance (ì‹¤ì‹œê°„ ì£¼ì‹/ì•”í˜¸í™”í ì‹œì„¸)
- **ë‰´ìŠ¤ í¬ë¡¤ë§**: BeautifulSoup4 4.14.3, requests

### UI/UX
- **ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬**: Altair 6.0.0
- **ì‹œê°í™”**: Streamlit ë‚´ì¥ `st.line_chart()`
- **ì´ë¯¸ì§€ ì²˜ë¦¬**: Pillow 12.1.0

---

## ğŸ”§ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### ERD (Entity-Relationship Diagram)

```sql
users (ì¢…ëª© í…Œì´ë¸”)
â”œâ”€â”€ id (PK, Auto Increment)
â”œâ”€â”€ nickname (UNIQUE, ì¢…ëª©ëª…)
â”œâ”€â”€ repo_url (GitHub ì €ì¥ì†Œ URL)
â””â”€â”€ created_at (ë“±ë¡ ì‹œê°„)

daily_commits (ì£¼ê°€ ì´ë ¥ í…Œì´ë¸”)
â”œâ”€â”€ id (PK, Auto Increment)
â”œâ”€â”€ user_id (FK â†’ users.id)
â”œâ”€â”€ commit_date (DATE)
â”œâ”€â”€ count (í•˜ë£¨ ì»¤ë°‹ ìˆ˜)
â””â”€â”€ Unique Key: (user_id, commit_date)
```

### í•µì‹¬ ì„¤ê³„ ì›ì¹™
- **ì¤‘ë³µ ë°©ì§€**: `UNIQUE KEY (user_id, commit_date)`ë¡œ ë™ì¼ ë‚ ì§œ ì¤‘ë³µ ì—…ë°ì´íŠ¸ ë°©ì§€
- **ë°ì´í„° ë¬´ê²°ì„±**: `ON DELETE CASCADE`ë¡œ ìœ ì € ì‚­ì œ ì‹œ ê´€ë ¨ ì»¤ë°‹ ê¸°ë¡ ìë™ ì‚­ì œ
- **íš¨ìœ¨ì  ì¡°íšŒ**: `commit_date` ì¸ë±ì‹±ìœ¼ë¡œ ì‹œê³„ì—´ ì¿¼ë¦¬ ìµœì í™”

---

## ğŸ”„ ì£¼ìš” ë°ì´í„° íë¦„

### 1. ìœ ì € ë“±ë¡ (Home.py)
```
ì‚¬ìš©ì ì…ë ¥ (ë‹‰ë„¤ì„, GitHub ì €ì¥ì†Œ URL)
    â†“
add_user_to_db() â†’ MySQL INSERT
    â†“
ì‚¬ìš©ì ì •ë³´ ì €ì¥ (users í…Œì´ë¸”)
```

### 2. ì»¤ë°‹ ë°ì´í„° ë™ê¸°í™” (utils.py)
```
sync_missing_data() í•¨ìˆ˜ ì‹¤í–‰
    â†“
users í…Œì´ë¸” ì „ì²´ ì¡°íšŒ
    â†“
ê° ìœ ì €ë³„ GitHub API í˜¸ì¶œ
    â”œâ”€ ì—”ë“œí¬ì¸íŠ¸: /repos/{owner}/{repo}/commits
    â”œâ”€ íŒŒë¼ë¯¸í„°: since=30ì¼ì „, per_page=100
    â””â”€ í—¤ë”: Authorization: token {GITHUB_TOKEN}
    â†“
ì»¤ë°‹ JSON íŒŒì‹± â†’ ë‚ ì§œë³„ ì§‘ê³„
    â†“
daily_commits í…Œì´ë¸” ë°°ì¹˜ INSERT/UPDATE (ON DUPLICATE KEY)
```

### 3. ë­í‚¹ ê³„ì‚° (1-Ranking.py)
```
daily_commits í…Œì´ë¸” ì¡°íšŒ (14ì¼ ìµœê·¼ ë°ì´í„°)
    â†“
pivot() â†’ ì‚¬ìš©ìë³„ ì—´ ë³€í™˜
    â†“
rolling(window=7, min_periods=1).mean() â†’ 7ì¼ MA ê³„ì‚°
    â†“
ë§ˆì§€ë§‰ 7ì¼ MA ê°’ ê¸°ì¤€ ì •ë ¬ â†’ ìƒìœ„ 10ëª… ì¶”ì¶œ
    â†“
í¬ë””ì›€ UI (1ìœ„, 2ìœ„, 3ìœ„) + ì°¨íŠ¸ ë Œë”ë§
```

### 4. ë‰´ìŠ¤ í¬ë¡¤ë§ (2-GEEKNEWS.py)
```
requestsë¡œ GeekNews ë©”ì¸ í˜ì´ì§€ GET
    â†“
BeautifulSoup íŒŒì‹± (select() ì‚¬ìš©)
    â†“
ì œëª©, URL, ì¢‹ì•„ìš” ìˆ˜ ì¶”ì¶œ
    â†“
ì¢‹ì•„ìš” ìˆ˜ ê¸°ì¤€ ì •ë ¬
    â†“
Streamlit ì¹´ë“œë¡œ ë Œë”ë§ (ìˆœìœ„ ë°°ì§€ í¬í•¨)
```

---

## ğŸ” ë³´ì•ˆ êµ¬í˜„

### ë¯¼ê° ì •ë³´ ê´€ë¦¬
- **ì €ì¥ì†Œ**: `.streamlit/secrets.toml` (git ë¬´ì‹œ í•„ìˆ˜)
- **í¬í•¨ í•­ëª©**:
  ```toml
  [mysql]
  host = "..."
  user = "..."
  password = "..."
  database = "..."
  port = 3306

  [github]
  token = "ghp_..."  # GitHub Personal Access Token (í´ë˜ì‹)
  ```

### GitHub API ì¸ì¦
- **í† í° ì¢…ë¥˜**: GitHub í´ë˜ì‹ Personal Access Token
- **ì¸ì¦ í—¤ë”**: `Authorization: token {token}`
- **Rate Limit**: ì¸ì¦ ì‹œ ì‹œê°„ë‹¹ 5,000 ìš”ì²­ (ë¯¸ì¸ì¦ 60 ìš”ì²­)

### ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
- **PyMySQL**: ìˆœìˆ˜ Python ë“œë¼ì´ë²„ë¡œ OS ì¢…ì†ì„± ì œê±°
- **SQLAlchemy URI**: `mysql+pymysql://user:pw@host:port/db`
- **ì„¸ì…˜ ê´€ë¦¬**: `init_connection()` ë° `init_engine()` íŒ©í† ë¦¬ í•¨ìˆ˜

---

## ğŸ“Š í•µì‹¬ ì•Œê³ ë¦¬ì¦˜

### 7ì¼ ì´ë™ í‰ê·  ê³„ì‚°

```python
# ì›ë³¸ ë°ì´í„°: daily_commits í…Œì´ë¸” ì¿¼ë¦¬
df['commit_date'] = pd.to_datetime(df['commit_date'])
chart_data = df.pivot(index='commit_date', columns='nickname', values='count').fillna(0)

# ì´ë™í‰ê·  ì ìš©
moving_avg_data = chart_data.rolling(window=7, min_periods=1).mean()

# ê²°ê³¼: ê° ë‚ ì§œë³„ë¡œ ì‚¬ìš©ìì˜ 7ì¼ MA ê°’
# min_periods=1: ì´ˆê¸° ë°ì´í„°(1-6ì¼)ë„ ë¶€ë¶„ í‰ê·  ê³„ì‚° ê°€ëŠ¥
```

**ìˆ˜í•™ì‹**: $$MA_t = \frac{1}{7} \sum_{i=0}^{6} count_{t-i}$$

### ì‚¬ìš©ì ìƒ‰ìƒ ìƒì„± (HSL ê¸°ë°˜)

```python
def get_user_color(user_id):
    base_hues = [210/360, 150/360, 35/360, 0/360, 260/360, 330/360, 190/360]
    cycle, hue_idx = divmod(user_id, len(base_hues))
    h = base_hues[hue_idx]
    s, l = max(0.2, 0.8 - (cycle * 0.2)), min(0.8, 0.6 + (cycle * 0.05))
    r, g, b = colorsys.hls_to_rgb(h, l, s)
    return '#%02x%02x%02x' % (int(r*255), int(g*255), int(b*255))
```

- **Hue**: ì‚¬ìš©ì ID ê¸°ë°˜ ìˆœí™˜ ë°°ì¹˜ (7ê°€ì§€ ê¸°ë³¸ ìƒ‰ìƒ)
- **Saturation**: ì‚¬ìš©ì ID ì¦ê°€ì— ë”°ë¼ ì ì§„ì ìœ¼ë¡œ ê°ì†Œ
- **Lightness**: ì‚¬ìš©ì ID ì¦ê°€ì— ë”°ë¼ ì ì§„ì ìœ¼ë¡œ ì¦ê°€
- **ëª©ì **: ë§ì€ ì‚¬ìš©ìë„ ì‹œê°ì ìœ¼ë¡œ êµ¬ë¶„ ê°€ëŠ¥í•œ ìƒ‰ìƒ ë°°ì •

---

## ğŸ¨ UI/UX ì„¤ê³„

### 1. ì‹¤ì‹œê°„ í‹°ì»¤ (Top Bar)
```html
<!-- ìŠ¤íƒ€ì¼: ê³ ì • ë°°ì¹˜, ê²€ì€ìƒ‰ ë°°ê²½, Cyan í…Œë‘ë¦¬ -->
<!-- ì½˜í…ì¸ : MSFT, NVDA, AAPL, BTC-USD ì‹¤ì‹œê°„ ì‹œì„¸ -->
<!-- ì• ë‹ˆë©”ì´ì…˜: CSS ticker 50ì´ˆ ë¬´í•œ ë£¨í”„ ìŠ¤í¬ë¡¤ -->
```

### 2. í¬ë””ì›€ ë ˆì´ì•„ì›ƒ (Top 3)
```
[2ìœ„ (ë†’ì´ 260px)]  [1ìœ„ (ë†’ì´ 300px)]  [3ìœ„ (ë†’ì´ 230px)]
      ğŸ¥ˆ                  ğŸ‘‘                  ğŸ¥‰
```

### 3. ì°¨íŠ¸ & ì¸ìš© (14ì¼ ë°ì´í„°)
- **ì¢Œì¸¡**: Altair ë¼ì¸ ì°¨íŠ¸ (Top 10 ì‚¬ìš©ì, 7D MA)
- **ìš°ì¸¡**: 4-10ìœ„ ìˆœìœ„ ì¹´ë“œ (ì¢Œì¸¡ ìƒ‰ìƒ ë°” í¬í•¨)

### 4. ë‰´ìŠ¤ ì¹´ë“œ (GeekNews)
- **í˜¸ë²„ íš¨ê³¼**: ë°°ê²½ ë¶ˆíˆ¬ëª…ë„ ì¦ê°€, Cyan ë³´ë”, 5px ìƒìŠ¹
- **ìˆœìœ„ ë°°ì§€**: ì¢Œìƒë‹¨ ì ˆëŒ€ ìœ„ì¹˜, íŒŒë€ìƒ‰â†’Cyan ê·¸ë˜ë””ì–¸íŠ¸
- **ì œëª©**: 1.3rem, ë°ì€ íšŒìƒ‰, í˜¸ë²„ ì‹œ Cyanìœ¼ë¡œ ë³€ê²½

---

## ğŸ”„ ë°ì´í„° ë™ê¸°í™” ì „ëµ

### ìë™ ê°±ì‹ 
- **íŠ¸ë¦¬ê±°**: Ranking í˜ì´ì§€ ë°©ë¬¸ ì‹œ `st.session_state['initialized']` ì²´í¬
- **ë¹ˆë„**: í˜ì´ì§€ ë¡œë“œë§ˆë‹¤ í•œ ë²ˆ (ì¤‘ë³µ ë°©ì§€)
- **ë²”ìœ„**: ìµœê·¼ 30ì¼ ë°ì´í„°ë§Œ GitHub APIì—ì„œ ì¡°íšŒ

### ë°°ì¹˜ ì—…ë°ì´íŠ¸
```python
batch_data = []
for i in range(31):
    target_date = (today_dt.date() - pd.Timedelta(days=i)).strftime('%Y-%m-%d')
    count = date_counts.get(target_date, 0)
    batch_data.append((user['id'], target_date, count))

cursor.executemany("""
    INSERT INTO daily_commits (user_id, commit_date, count)
    VALUES (%s, %s, %s)
    ON DUPLICATE KEY UPDATE count = VALUES(count)
""", batch_data)
```

**ì¥ì **:
- í•œ ë²ˆì˜ ë°°ì¹˜ ì—°ì‚°ìœ¼ë¡œ ìµœëŒ€ 31ê°œ í–‰ ì‚½ì…
- ì¤‘ë³µ ì‹œ ìë™ìœ¼ë¡œ count ê°’ë§Œ ì—…ë°ì´íŠ¸

---

## ğŸš€ ë°°í¬ & ì‹¤í–‰

### ë¡œì»¬ ì‹¤í–‰
```bash
pip install -r requirements.txt
streamlit run Home.py
```

### Streamlit Cloud ë°°í¬
1. GitHub ì €ì¥ì†Œ ì—°ê²°
2. `.streamlit/secrets.toml` ì„¤ì • (Cloud Dashboardì—ì„œ í™˜ê²½ë³€ìˆ˜ ì¶”ê°€)
3. Deploy ë²„íŠ¼ í´ë¦­

---

## ğŸ› ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… & ê°œì„  ì‚¬í•­

### 1. ë³´ì•ˆ: ë¯¼ê° ì •ë³´ ë…¸ì¶œ ë°©ì§€
**ë¬¸ì œ**: GitHub í† í° ë° DB ì ‘ì†ì •ë³´ê°€ ì½”ë“œì— í•˜ë“œì½”ë”©ë˜ì–´ ìˆìŒ  
**í•´ê²°**: Streamlit `secrets.toml` ë„ì…
- ê°œë°œ: `.streamlit/secrets.toml` (ë¡œì»¬ íŒŒì¼)
- ë°°í¬: Streamlit Cloud ì•± ì„¤ì •ì—ì„œ í™˜ê²½ë³€ìˆ˜ ì…ë ¥
- `.gitignore`ì— `secrets.toml` ì¶”ê°€

### 2. ì•ˆì •ì„±: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜
**ë¬¸ì œ**: MySQL ì„¸ì…˜ ë§Œë£Œ ë˜ëŠ” ì¸ì¦ ì‹¤íŒ¨ ì‹œ ë°ì´í„° ì¡°íšŒ ë¶ˆê°€  
**í•´ê²°**:
- `init_connection()`: `pymysql.cursors.DictCursor` ì‚¬ìš© (CRUD)
- `init_engine()`: SQLAlchemy ì—”ì§„ ìºì‹± (Pandas read_sql)
- ë‘ ê°€ì§€ ì—°ê²° ë°©ì‹ìœ¼ë¡œ ì•ˆì •ì„± í–¥ìƒ
- GitHub API 401 ì˜¤ë¥˜ ì‹œ ë¡œê·¸ ì¶œë ¥ìœ¼ë¡œ ë””ë²„ê¹… ìš©ì´

### 3. ê°€ë…ì„±: ì°¨íŠ¸ì˜ ê·¹ì‹¬í•œ ë°ì´í„° ê²©ì°¨
**ë¬¸ì œ**: ì‚¬ìš©ì ê°„ ì»¤ë°‹ íšŸìˆ˜ ì°¨ì´ê°€ í¬ë©´ ì°¨íŠ¸ ê°€ë…ì„± ì €í•˜  
**í•´ê²°**: **7ì¼ ì´ë™ í‰ê· (7D Moving Average)** ë„ì…
- ì›ë³¸: `[0, 5, 2, 10, 15, 3, 8, 1, 20, ...]`
- MA (window=7): `[0, 2.5, 2.33, 5.29, 7, 7.71, 8.29, 7.71, 11, ...]`
- ë‹¨ê¸° ë…¸ì´ì¦ˆ ì œê±° â†’ ì¤‘ì¥ê¸° ì¶”ì„¸ ì‹œê°í™” ê°€ëŠ¥

### 4. ì„±ëŠ¥: API Rate Limit ê´€ë¦¬
**ë¬¸ì œ**: ì‚¬ìš©ì ì¦ê°€ ì‹œ GitHub API í˜¸ì¶œ ì´ˆê³¼  
**í•´ê²°**:
- Streamlit `@st.cache_data(ttl=300)` ìºì‹± (5ë¶„ ê°„ê²©)
- ê°œì¸ í† í° ì‚¬ìš©ìœ¼ë¡œ Rate Limit 60 â†’ 5,000/hour ìƒí–¥
- ë°°ì¹˜ ì²˜ë¦¬ë¡œ ì¿¼ë¦¬ ìˆ˜ ìµœì†Œí™”

---

## ğŸ“ ë¼ì´ì„ ìŠ¤ ë° ê¸°ì—¬

ì´ í”„ë¡œì íŠ¸ëŠ” êµìœ¡ ë° ê°œì¸ ìš©ë„ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.  
ê°œì„  ì‚¬í•­ ë° ë²„ê·¸ ë¦¬í¬íŠ¸ëŠ” GitHub Issuesë¥¼ í†µí•´ ì œì¶œí•´ì£¼ì„¸ìš”.
